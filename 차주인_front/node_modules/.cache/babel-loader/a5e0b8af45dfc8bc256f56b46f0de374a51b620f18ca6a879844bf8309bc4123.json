{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useDispatch,useSelector}from\"react-redux\";import{Link,useNavigate,useParams}from'react-router-dom';import\"../../css/page-board.css\";import Layout from\"../../layout/Layout\";import Button from\"../../component/Button\";import Input from'../../component/Input';import InputFileMulti from'../../component/InputFileMulti';import*as APIS from\"../../utils/service\";import{loadingflas}from'../../redux/popupSlice';import{API_URL}from'../../libs/apiUrl';import{goBackPage}from'../../utils/utils';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function BoardAdd(_ref){let{navigation}=_ref;const dispatch=useDispatch();const navigate=useNavigate();const params=new URLSearchParams(window.location.search);const[boardInfo,setBoardInfo]=useState({});const[idx,setIdx]=useState(null);const[title,setTitle]=useState(\"\");const[fileVal,setFileVal]=useState([]);const[desc,setDesc]=useState(\"\");const[deleteFiles,setDeleteFiles]=useState([]);useEffect(()=>{console.log(deleteFiles);},[deleteFiles]);const sendBoard=()=>{let sendData={idx:idx,// 있으면 수정 없으면 등록 \ntitle:\"\",// 제목\ndesc:\"\",// 상세 내용\nfiles:[],delete_files:deleteFiles};let err=[];if(title)sendData.title=title;else err.push(\"제목\");if(desc)sendData.desc=desc;else err.push(\"내용\");if(fileVal)sendData.files=fileVal;if(err.length>0){// console.log(err)\nreturn;}// console.log(\"senddata ::\", sendData)\n// console.log(\"등록하기..\")\nAPIS.postData(API_URL.board.insert,sendData).then(result=>{dispatch(loadingflas({loading:false}));goBackPage(navigate);}).catch(e=>{dispatch(loadingflas({loading:false}));});};const losdBoard=function(idx){let init=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;APIS.postData(API_URL.board.info,{idx,init}).then(result=>{let info=result.data;setIdx(info===null||info===void 0?void 0:info.idx);setTitle(info===null||info===void 0?void 0:info.title);setFileVal(info===null||info===void 0?void 0:info.files.map(v=>v));setDesc(info===null||info===void 0?void 0:info.desc);}).catch(e=>{goBackPage(navigate);});};const deleteBoard=()=>{APIS.postData(API_URL.board.delete,{idx}).then(result=>{dispatch(loadingflas({loading:false}));// console.log(result.data)\ngoBackPage(navigate);}).catch(e=>{dispatch(loadingflas({loading:false}));});};useEffect(()=>{if(params.get(\"idx\")){// console.log(\"수정하기 글\")\nlosdBoard(params.get(\"idx\"));}else{// console.log(\"새글\")\n}},[]);return/*#__PURE__*/_jsx(Layout,{header:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"boardAddContain\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"global-titleBox bg_white\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/icons/back.svg\",alt:\"\",onClick:()=>{goBackPage(navigate);}}),/*#__PURE__*/_jsx(\"div\",{className:\"titleInfo\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[\"\\uAE00\",idx?\" 수정하기\":\"쓰기\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"infoBox\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"add-content-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"add-title\",children:\"\\uC81C\\uBAA9 (30\\uC790 \\uC774\\uB0B4)\"}),/*#__PURE__*/_jsx(Input,{className:\"inputs\",placeholder:\"\\uC81C\\uBAA9\\uC744 \\uC785\\uB825\\uD574 \\uC8FC\\uC138\\uC694.\",setValue:setTitle,value:title,maxlength:30})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-content-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"add-title\",children:\"\\uC774\\uBBF8\\uC9C0\"}),/*#__PURE__*/_jsx(InputFileMulti,{type:\"file\",multiple:true,name:\"board-add-img-file\",onDelete:v=>{setDeleteFiles([...deleteFiles,v]);},value:fileVal,setValue:setFileVal,valid:\"image\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-content-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"add-title\",children:\"\\uB0B4\\uC6A9 (1000\\uC790 \\uC774\\uB0B4)\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"text-box\",placeholder:\"\\uB0B4\\uC6A9\\uC744 \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",value:desc,onChange:e=>{setDesc(e.target.value);},maxLength:1000})]}),/*#__PURE__*/_jsx(Button,{buttonTxt:\"\".concat(idx?\"수정\":\"등록\",\"\\uD558\\uAE30\"),onPress:sendBoard,buttonSize:\"large\"})]})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}