{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useDispatch,useSelector}from\"react-redux\";import{Link,useLocation,useNavigate}from'react-router-dom';import{open,close,loadingflas,showLoginPopup}from'../../redux/popupSlice';import\"../../css/page-joboffer.css\";import Layout from\"../../layout/Layout\";import Selector from\"../../component/Select\";import Button from\"../../component/Button\";import*as APIS from\"../../utils/service\";import{API_URL}from'../../libs/apiUrl';import{AutoSizer,List,WindowScroller}from'react-virtualized';import{numFormat}from'../../utils/utils';import{TextCheckBox}from'../../component/TextCheck';import{PayOption,SidoOption,TonOption}from'../../component/popups/CarOption';import moment from'moment';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function JobOffer(_ref){let{navigation}=_ref;const dispatch=useDispatch();const navigate=useNavigate();const location=useLocation();const[isLogin,setLogin]=useState(localStorage.getItem(\"token\")?true:false);const[srRowHeight,setSrRowHeight]=useState(326);const[order,setOrder]=useState(1);const[myView,setMyView]=useState(false);const[offerList,setOfferList]=useState([]);const[viewList,setViewList]=useState([]);const[filterSido,seFilterSido]=useState(\"\");const[filterTon,setFilterTon]=useState(\"\");const[filterPay,setFilterPay]=useState({min:null,max:null});const categoryClick=index=>{if(index==0){dispatch(open({component:/*#__PURE__*/_jsx(SidoOption,{setValue:filterSido,onChange:seFilterSido}),onCancelPress:false,titleviewer:true,title:\"지역\",button:\"초기화\",buttonStyle:\"reset\",onPress:()=>{dispatch(close());seFilterSido(\"\");},noneMt:true}));}else if(index==1){dispatch(open({component:/*#__PURE__*/_jsx(TonOption,{setValue:filterTon,onChange:setFilterTon}),onCancelPress:false,titleviewer:true,title:\"차종\",button:\"초기화\",buttonStyle:\"reset\",onPress:()=>{dispatch(close());setFilterTon(\"\");},noneMt:true}));}else if(index==2){dispatch(open({component:/*#__PURE__*/_jsx(PayOption,{setValue:filterPay,onChange:v=>{setFilterPay(v);}}),onCancelPress:false,titleviewer:true,title:\"월급여\",button:\"초기화\",buttonStyle:\"reset\",onPress:()=>{dispatch(close());setFilterPay({min:null,max:null});},noneMt:true}));}};useEffect(()=>{filterList();},[filterSido,filterTon,filterPay]);const filterList=()=>{let filterData=offerList.filter(v=>{let isSelect=true;if(filterSido&&v.go_sido!=filterSido)isSelect=false;if(filterTon&&v.ton!=filterTon)isSelect=false;if(filterPay.min&&Number(v.pay)<Number(filterPay.min))isSelect=false;if(filterPay.max&&Number(v.pay)>Number(filterPay.max))isSelect=false;return isSelect;});setViewList(filterData);};//윈도우 가로사이즈 체크\nconst checkWindowWidth=()=>{const width=window.innerWidth;if(width<800){setSrRowHeight(566);}else{setSrRowHeight(326);}};const loadList=()=>{dispatch(loadingflas({loading:true}));APIS.postData(API_URL.jobOffer.list,{order:order,my:myView}).then(result=>{console.log(\"joboffer List:\",result.data);setOfferList(result.data);dispatch(loadingflas({loading:false}));}).catch(e=>{console.log(e);dispatch(loadingflas({loading:false}));});};useEffect(()=>{console.log(\"render joboffer!\");if(location.state){if(location.state.isMyView)setMyView(true);}checkWindowWidth();window.onresize=function(){checkWindowWidth();};},[]);useEffect(()=>{filterList();},[offerList]);useEffect(()=>{loadList();},[order,myView]);return/*#__PURE__*/_jsx(Layout,{header:true,actives:\"jobOffer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"jobOfferContain\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"categoryBox\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"categoryBtn \".concat(filterSido&&\"select\"),onClick:()=>categoryClick(0),children:\"\\uC9C0\\uC5ED\"}),/*#__PURE__*/_jsx(\"div\",{className:\"categoryBtn \".concat(filterTon&&\"select\"),onClick:()=>categoryClick(1),children:\"\\uCC28\\uC885\"}),/*#__PURE__*/_jsx(\"div\",{className:\"categoryBtn \".concat((filterPay.min||filterPay.max)&&\"select\"),onClick:()=>categoryClick(2),children:\"\\uC6D4\\uAE09\\uC5EC\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"subCategoryBox\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:10},children:[/*#__PURE__*/_jsx(Selector,{subselectClass:\"selBox\",values:order,setValues:setOrder,selectData:[{values:1,labels:\"최신순\"},{values:2,labels:\"조회순\"}]}),/*#__PURE__*/_jsx(TextCheckBox,{name:\"bmv-check\",text:\"\\uB0B4 \\uAE00 \\uBCF4\\uAE30\",isIcon:true,checked:myView,onChange:v=>{setMyView(v);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sellbtn\",children:/*#__PURE__*/_jsx(Button,{titleimgs:\"/images/icons/plus.svg\",buttonTxt:\"\\uAD6C\\uC778 \\uB4F1\\uB85D\",onPress:()=>{if(isLogin)navigate(\"/jobofferAdd\");else dispatch(showLoginPopup({onPress:()=>{dispatch(close());navigate(\"/login\");}}));}})})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',width:\"100%\",marginTop:20,gap:20},children:/*#__PURE__*/_jsx(WindowScroller,{children:_ref2=>{let{height,scrollTop,isScrolling,onChildScroll}=_ref2;return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(AutoSizer,{disableHeight:true,children:_ref3=>{let{width}=_ref3;return/*#__PURE__*/_jsx(List,{ref:el=>{window.listEl=el;},autoHeight:true,height:height,isScrolling:isScrolling,onScroll:onChildScroll,overscanRowCount:0,rowCount:Math.ceil(viewList.length/2),rowHeight:srRowHeight,rowRenderer:_ref4=>{let{index,isScrolling,isVisible,key,style}=_ref4;let startIndex=index*2;const row1=viewList[startIndex];const row2=startIndex+1<=viewList.length-1?viewList[startIndex+1]:null;// positio top width height left\nreturn/*#__PURE__*/_jsx(\"div\",{style:style,children:/*#__PURE__*/_jsxs(\"div\",{className:\"offer-list-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card \".concat((row1===null||row1===void 0?void 0:row1.status)==2&&\"disable\"),onClick:()=>{if(isLogin)window.open(\"/jobofferInfo?idx=\"+(row1===null||row1===void 0?void 0:row1.idx));else dispatch(showLoginPopup({onPress:()=>{dispatch(close());navigate(\"/login\");}}));},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title\",children:[row1===null||row1===void 0?void 0:row1.ton,\"\\uD1A4\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"sub-title\",children:row1===null||row1===void 0?void 0:row1.title}),/*#__PURE__*/_jsx(\"div\",{className:\"line\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\uCD9C\\uADFC\\uC9C0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[row1===null||row1===void 0?void 0:row1.go_sido,\" \",row1===null||row1===void 0?void 0:row1.go_sigungu]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\uC6D4\\uAE09\\uC5EC\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[numFormat(row1===null||row1===void 0?void 0:row1.pay),\"\\uB9CC\\uC6D0\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\uB4F1\\uB85D\\uC77C\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text\",children:moment(row1===null||row1===void 0?void 0:row1.create_dt).format(\"YYYY.MM.DD\")})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"state \".concat((row1===null||row1===void 0?void 0:row1.status)==2&&\"disable\"),children:(row1===null||row1===void 0?void 0:row1.status)==2?\"모집 마감\":\"채용시 마감\"})]}),row2&&/*#__PURE__*/_jsxs(\"div\",{className:\"card \".concat((row2===null||row2===void 0?void 0:row2.status)==2&&\"disable\"),onClick:()=>{if(isLogin)window.open(\"/jobofferInfo?idx=\"+(row2===null||row2===void 0?void 0:row2.idx));else dispatch(showLoginPopup({onPress:()=>{dispatch(close());navigate(\"/login\");}}));},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title\",children:[row2===null||row2===void 0?void 0:row2.ton,\"\\uD1A4\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"sub-title\",children:row2===null||row2===void 0?void 0:row2.title}),/*#__PURE__*/_jsx(\"div\",{className:\"line\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\uCD9C\\uADFC\\uC9C0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[row2===null||row2===void 0?void 0:row2.go_sido,\" \",row2===null||row2===void 0?void 0:row2.go_sigungu]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\uC6D4\\uAE09\\uC5EC\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[numFormat(row2===null||row2===void 0?void 0:row2.pay),\"\\uB9CC\\uC6D0\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"\\uB4F1\\uB85D\\uC77C\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text\",children:moment(row2===null||row2===void 0?void 0:row2.create_dt).format(\"YYYY.MM.DD\")})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"state \".concat((row2===null||row2===void 0?void 0:row2.status)==2&&\"disable\"),children:(row2===null||row2===void 0?void 0:row2.status)==2?\"모집 마감\":\"채용시 마감\"})]})]})},key);},scrollToIndex:0,scrollTop:scrollTop,width:width});}})});}})})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}