{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useDispatch,useSelector}from\"react-redux\";import axios from'axios';import KakaoLogin from\"react-kakao-login\";import Layout from\"../../layout/Layout\";import{useropen}from'../../redux/userSlice';import{open,close,loadingflas}from'../../redux/popupSlice';import{Link,useNavigate,useParams}from'react-router-dom';import*as APIS from\"../../utils/service\";import{getKakaoInfo,openKakao}from'../../utils/kakaoLogin';import{getNaverInfo,openNaver,parseCallBack}from'../../utils/naverLogin';import{API_URL}from'../../libs/apiUrl';import{randomNumberLength}from'../../utils/utils';import{selectConfig}from'../../redux/configSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(_ref){let{navigation}=_ref;const{naver}=window;const dispatch=useDispatch();const navigate=useNavigate();const{configInfo}=useSelector(selectConfig);const appkeyNaver=\"wK8OYBcyFxxj6rQOuhGl\";const appkeyKakao=\"40e4bc36f09d62e628ff01009b3b5fa7\";const params=useParams();useEffect(()=>{let token=localStorage.getItem(\"token\");console.log(\"üöÄ ~ useEffect ~ token:\",token);if(token){navigate(\"/\");return;}initializeNaverLogin();},[]);const requestLogin=data=>{let{type,id,email,hp,name,profile}=data;APIS.postData(API_URL.login,{type,id,email,hp,name,profile}).then(result=>{localStorage.setItem(\"token\",result.data);if(window.location.hostname===\"localhost\"){window.location.href=\"http://localhost:3000\";}else{window.location.href=\"https://chajooin.com\";}}).catch(e=>{var _result$data,_result$data2,_configInfo$footer,_result$data3,_result$data3$data,_result$data4,_result$data4$data;let result=e.response;dispatch(open({content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{style:{width:\"100%\",textAlign:\"center\"},className:\"bolds fontsize20\",children:result!==null&&result!==void 0&&(_result$data=result.data)!==null&&_result$data!==void 0&&_result$data.msg?result.data.msg:\"Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.\"}),(result===null||result===void 0?void 0:(_result$data2=result.data)===null||_result$data2===void 0?void 0:_result$data2.code)===1000&&/*#__PURE__*/_jsxs(\"p\",{className:\"margint12\",children:[\"\\uACE0\\uAC1D\\uC13C\\uD130\\uC5D0 \\uBB38\\uC758\\uD558\\uC138\\uC694. (\",configInfo===null||configInfo===void 0?void 0:(_configInfo$footer=configInfo.footer)===null||_configInfo$footer===void 0?void 0:_configInfo$footer.hp,\")\"]}),(result===null||result===void 0?void 0:(_result$data3=result.data)===null||_result$data3===void 0?void 0:(_result$data3$data=_result$data3.data)===null||_result$data3$data===void 0?void 0:_result$data3$data.type)&&/*#__PURE__*/_jsxs(\"p\",{className:\"margint12 bolds\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"color666\",children:\"\\uAC00\\uC785\\uC720\\uD615:\"}),\" \",result.data.data.type]}),(result===null||result===void 0?void 0:(_result$data4=result.data)===null||_result$data4===void 0?void 0:(_result$data4$data=_result$data4.data)===null||_result$data4$data===void 0?void 0:_result$data4$data.email)&&/*#__PURE__*/_jsxs(\"p\",{className:\"margint12 bolds\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"color666\",children:\"\\uC774\\uBA54\\uC77C:\"}),\" \",result.data.data.email]})]}),onCancelPress:false,titleviewer:false,button:\"ÌôïÏù∏\",onPress:()=>{dispatch(close());navigate(\"/login\");}}));});};const initializeNaverLogin=()=>{const naverLogin=new naver.LoginWithNaverId({clientId:appkeyNaver,// Î∞úÍ∏â Î∞õÏùÄ Client ID ÏûÖÎ†•\n// callbackUrl: 'http://localhost:3000/login', // ÏûëÏÑ±ÌñàÎçò Callback URL ÏûÖÎ†• \ncallbackUrl:'https://chajooin.com/login',// TODO: Î∞∞Ìè¨Ïãú Î≥ÄÍ≤Ω\nisPopup:false,// ÌåùÏóÖÏ∞ΩÏúºÎ°ú Î°úÍ∑∏Ïù∏ÏùÑ ÏßÑÌñâÌï† Í≤ÉÏù∏ÏßÄ?           \nloginButton:{color:'green',type:1,height:58},// Î≤ÑÌäº ÌÉÄÏûÖ ( ÏÉâÏÉÅ, ÌÉÄÏûÖ, ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω Í∞ÄÎä• )\ncallbackHandle:false});naverLogin.init();let token=localStorage.getItem(\"token\");console.log(\"üöÄ ~ initializeNaverLogin ~ token:\",token);if(!token){console.log(\"üöÄ ~ initializeNaverLogin ~ !token:\",token);naverLogin.logout();}naverLogin.getLoginStatus(async function(status){if(status){handleNaverLogin(naverLogin===null||naverLogin===void 0?void 0:naverLogin.user);}else{console.log(\"ÎÑ§Ïù¥Î≤Ñ Î°úÍ∑∏Ïù∏ ÌïÑÏöî\");}});};//ÎÑ§Ïù¥Î≤Ñ Î°úÍ∑∏Ïù∏ ÏΩúÎ∞±\nconst handleNaverLogin=data=>{// return\nif(data.id){requestLogin({id:data.id,type:\"naver\",email:data.email,hp:data.mobile.replaceAll(\"-\",\"\"),name:data.name,profile:data.profile_image});}else{dispatch(open({content:\"Î°úÍ∑∏Ïù∏ Ï†ïÎ≥¥Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.\",onCancelPress:false,titleviewer:false,button:\"ÌôïÏù∏\",onPress:()=>{dispatch(close());}}));}};//Ïπ¥Ïπ¥Ïò§ Î°úÍ∑∏Ïù∏ ÏΩúÎ∞±\nconst kakaoOnSuccess=async data=>{// console.log(data)\n// return\nrequestLogin({id:data.profile.id,type:\"kakao\",email:data.profile.kakao_account.email,hp:data.profile.kakao_account.phone_number.replaceAll(\"+82 \",\"0\").replaceAll(\"-\",\"\"),name:data.profile.kakao_account.name,profile:data.profile.kakao_account.profile.profile_image_url});};const kakaoOnFailure=error=>{dispatch(open({content:\"Î°úÍ∑∏Ïù∏Ïóê Ïã§Ìå®ÌïòÏòÄÏäµÎãàÎã§.\",onCancelPress:false,titleviewer:false,button:\"ÌôïÏù∏\",onPress:()=>{dispatch(close());}}));};return/*#__PURE__*/_jsx(Layout,{header:true,children:/*#__PURE__*/_jsx(\"div\",{className:\"loginCotain\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loginBox\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title\",children:\"\\uB85C\\uADF8\\uC778\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[\"\\uC2E0\\uADDC\\uAC00\\uC785\\uC2DC \",/*#__PURE__*/_jsx(\"span\",{className:\"point\",children:\"2000P\"}),\" \\uBB34\\uB8CC\\uC9C0\\uAE09\"]}),/*#__PURE__*/_jsx(\"img\",{src:\"/images/icons/logo-truck.svg\",alt:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttonBox\",children:[/*#__PURE__*/_jsx(KakaoLogin,{token:appkeyKakao,scopes:['phone_number','name','profile_image','id','account_email'],onSuccess:kakaoOnSuccess,onFail:kakaoOnFailure,onLogout:console.info,render:_ref2=>{let{onClick}=_ref2;return/*#__PURE__*/ (// <button type=\"button\" className=\"btn btn1\" onClick={onClick}>Ïπ¥Ïπ¥Ïò§Î°úÍ∑∏Ïù∏2</button>\n_jsxs(\"div\",{className:\"button kakao\",onClick:onClick,children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/icons/kakao.svg\",alt:\"\"}),\"\\uCE74\\uCE74\\uC624\\uB85C \\uC2DC\\uC791\\uD558\\uAE30\"]}));}}),/*#__PURE__*/_jsxs(\"div\",{className:\"button naver\",onClick:()=>{document.querySelector(\"#naverIdLogin_loginButton\").click();},children:[/*#__PURE__*/_jsx(\"img\",{src:\"/images/icons/naver.svg\",alt:\"\"}),\"\\uB124\\uC774\\uBC84\\uB85C \\uC2DC\\uC791\\uD558\\uAE30\"]}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"none\"},id:\"naverIdLogin\"})]})]})})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}